<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TENNIS CD9 2026</title>
    <style>
        :root {
            --primary: #1b5e20;
            --accent: #ffff00;
            --dark: #121212;
            --bg: #f4f4f4;
        }

        body {
            margin: 0;
            font-family: -apple-system, system-ui, sans-serif;
            background: var(--bg);
            color: #333;
        }

        header {
            background: var(--dark);
            color: var(--accent);
            text-align: center;
            padding: 12px 0;
            font-size: 18px;
            font-weight: 800;
            text-transform: uppercase;
            border-bottom: 3px solid var(--primary);
        }

        nav {
            display: flex;
            background: #222;
            position: sticky;
            top: 0;
            z-index: 1000;
            overflow-x: auto;
        }

        nav button {
            flex: 1;
            padding: 12px 5px;
            background: none;
            color: #aaa;
            border: none;
            font-weight: bold;
            font-size: 11px;
            text-transform: uppercase;
            cursor: pointer;
            white-space: nowrap;
        }

        nav button.active {
            color: #fff;
            background: var(--primary);
        }

        section { display: none; padding: 8px; }
        section.active { display: block; }

        /* Bảng hiển thị vừa vặn màn hình */
        .table-wrapper {
            background: white;
            border-radius: 4px;
            overflow: hidden; /* Không cho tràn */
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        table {
            width: 100%; /* Ép bảng luôn nằm trong màn hình */
            border-collapse: collapse;
            table-layout: auto; 
        }

        th, td {
            border: 1px solid #ddd;
            padding: 6px 2px; /* Giảm padding tối đa */
            text-align: center; /* Căn giữa nội dung */
            vertical-align: middle;
            font-size: 12px; /* Font nhỏ để vừa màn hình mobile */
            word-break: break-word; /* Tự xuống dòng nếu nội dung quá dài */
        }

        th {
            background: #eee;
            color: #000;
            font-weight: bold;
            font-size: 10px;
        }

        /* Format riêng cho trang MATCHES */
        .score {
            font-weight: 800;
            color: #d32f2f;
            background: #fffde7 !important;
            width: 25px; /* Ép cột tỷ số nhỏ lại */
        }

        .player-name {
            font-weight: 500;
            line-height: 1.2;
            color: #1a237e;
        }

        .loading { text-align: center; padding: 40px; font-style: italic; color: #666; }

        /* Tối ưu cực độ cho màn hình rất nhỏ */
        @media (max-width: 380px) {
            th, td { font-size: 10px; padding: 4px 1px; }
            header { font-size: 15px; }
        }
    </style>
</head>
<body>

<header>TENNIS CD9 2026</header>

<nav>
    <button onclick="showTab(event, 'BXH')" class="active">BXH</button>
    <button onclick="showTab(event, 'MATCHES')">MATCHES</button>
    <button onclick="showTab(event, 'TEAMS')">TEAMS</button>
    <button onclick="showTab(event, 'PAIRS')">PAIRS</button>
    <button onclick="showTab(event, 'CHECK')">CHECK</button>
</nav>

<div id="content">
    <section id="BXH" class="active"><div class="loading">Đang tải...</div></section>
    <section id="MATCHES"><div class="loading">Đang tải...</div></section>
    <section id="TEAMS"><div class="loading">Đang tải...</div></section>
    <section id="PAIRS"><div class="loading">Đang tải...</div></section>
    <section id="CHECK"><div class="loading">Đang tải...</div></section>
</div>

<script>
const SHEET_ID = "1pak2Yy4rZ3U50rYj2rlfCOkqyDDpnOns";

function showTab(e, id) {
    document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    e.currentTarget.classList.add('active');
}

async function loadSheet(sheetName, targetId) {
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(sheetName)}`;
    
    try {
        const r = await fetch(url);
        const txt = await r.text();
        const json = JSON.parse(txt.substring(47).slice(0, -2));
        const rows = json.table.rows;
        const cols = json.table.cols;

        let html = `<div class="table-wrapper"><table><thead><tr>`;
        
        // Header
        for(let i=0; i < cols.length; i++) {
            let label = cols[i].label ? cols[i].label : "";
            // Rút gọn tiêu đề nếu cần để tiết kiệm diện tích mobile
            if(label === "NGÀY") label = "N";
            if(label === "THÁNG") label = "T";
            if(label === "NĂM") label = "Năm";
            html += `<th>${label}</th>`;
        }
        html += `</tr></thead><tbody>`;

        rows.forEach(row => {
            if (!row.c.some(cell => cell && cell.v !== null)) return;

            html += `<tr>`;
            for(let i=0; i < cols.length; i++) {
                let cell = row.c[i];
                let val = "";
                if (cell) {
                    val = cell.f ? cell.f : (cell.v !== null ? cell.v : "");
                }

                let className = "";
                if (targetId === "MATCHES") {
                    if (i === 4 || i === 5) className = "score";
                    if (i === 3 || i === 6) className = "player-name";
                }
                
                html += `<td class="${className}">${val}</td>`;
            }
            html += `</tr>`;
        });

        html += `</tbody></table></div>`;
        document.getElementById(targetId).innerHTML = html;
    } catch (err) {
        document.getElementById(targetId).innerHTML = "Lỗi tải dữ liệu.";
    }
}

window.addEventListener('DOMContentLoaded', () => {
    loadSheet("BXH", "BXH");
    loadSheet("MATCHES", "MATCHES");
    loadSheet("TEAMS", "TEAMS");
    loadSheet("PAIRS", "PAIRS");
    loadSheet("CHECK", "CHECK");
});
</script>

</body>
</html>
