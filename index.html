<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TENNIS ƒê·ªäNH M·ªÜNH CD9 2026</title>
    <style>
        :root {
            --primary: #1b5e20;
            --accent: #ffff00;
            --dark: #121212;
            --bg: #f0f0f0;
        }

        body {
            margin: 0;
            font-family: -apple-system, system-ui, sans-serif;
            background: var(--bg);
            color: #333;
            padding-bottom: 50px;
        }

        header {
            background: var(--dark);
            color: var(--accent);
            text-align: center;
            padding: 20px 0;
            font-size: 22px;
            font-weight: 900;
            text-transform: uppercase;
            border-bottom: 4px solid var(--primary);
            position: sticky;
            top: 0;
            z-index: 2000;
        }

        /* Ti√™u ƒë·ªÅ t·ª´ng ph√¢n m·ª•c */
        .section-title {
            background: var(--primary);
            color: white;
            padding: 10px;
            margin-top: 20px;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: sticky;
            top: 65px; /* Ngay d∆∞·ªõi header */
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .container {
            padding: 10px;
            max-width: 100%;
        }

        .table-wrapper {
            background: white;
            margin-bottom: 10px;
            overflow-x: auto;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed; /* Gi·ªØ c·ªôt c·ªë ƒë·ªãnh, kh√¥ng b·ªã nh·∫£y */
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px 2px;
            text-align: center;
            vertical-align: middle;
            font-size: 12px;
            word-wrap: break-word;
        }

        th {
            background: #f8f9fa;
            color: #000;
            font-weight: bold;
            font-size: 11px;
        }

        /* ƒê·ªãnh d·∫°ng c·ªôt cho trang MATCHES (7 c·ªôt) */
        .tbl-matches th:nth-child(1), .tbl-matches td:nth-child(1) { width: 30px; } /* N */
        .tbl-matches th:nth-child(2), .tbl-matches td:nth-child(2) { width: 30px; } /* T */
        .tbl-matches th:nth-child(3), .tbl-matches td:nth-child(3) { width: 45px; } /* NƒÉm */
        .tbl-matches th:nth-child(4), .tbl-matches td:nth-child(4) { width: auto; text-align: right; padding-right: 5px; } /* ƒê·ªôi 1 */
        .tbl-matches th:nth-child(5), .tbl-matches td:nth-child(5) { width: 30px; background: #fffde7 !important; font-weight: bold; color: red; } /* S1 */
        .tbl-matches th:nth-child(6), .tbl-matches td:nth-child(6) { width: 30px; background: #fffde7 !important; font-weight: bold; color: red; } /* S2 */
        .tbl-matches th:nth-child(7), .tbl-matches td:nth-child(7) { width: auto; text-align: left; padding-left: 5px; } /* ƒê·ªôi 2 */

        /* CƒÉn gi·ªØa ch·ªØ trong √¥ t·ª∑ s·ªë */
        .score-val {
            display: block;
            width: 100%;
            text-align: center;
        }

        .loading {
            text-align: center;
            padding: 30px;
            font-style: italic;
            color: #888;
        }

        /* Kho·∫£ng c√°ch gi·ªØa c√°c b·∫£ng */
        section { margin-bottom: 30px; }

        @media (max-width: 480px) {
            th, td { font-size: 11px; }
            .section-title { font-size: 14px; }
        }
    </style>
</head>
<body>

<header>TENNIS ƒê·ªäNH M·ªÜNH CD9 2026</header>

<div class="container">
    <section id="sec-BXH">
        <div class="section-title">üèÜ B·∫£ng X·∫øp H·∫°ng (BXH)</div>
        <div id="BXH" class="loading">ƒêang t·∫£i d·ªØ li·ªáu...</div>
    </section>

    <section id="sec-MATCHES">
        <div class="section-title">üéæ L·ªãch Thi ƒê·∫•u & K·∫øt Qu·∫£</div>
        <div id="MATCHES" class="loading">ƒêang t·∫£i d·ªØ li·ªáu...</div>
    </section>

    <section id="sec-TEAMS">
        <div class="section-title">üë• Danh S√°ch Teams</div>
        <div id="TEAMS" class="loading">ƒêang t·∫£i d·ªØ li·ªáu...</div>
    </section>

    <section id="sec-PAIRS">
        <div class="section-title">ü§ù Danh S√°ch C·∫∑p ƒê·∫•u</div>
        <div id="PAIRS" class="loading">ƒêang t·∫£i d·ªØ li·ªáu...</div>
    </section>

    <section id="sec-CHECK">
        <div class="section-title">‚úÖ Ki·ªÉm Tra (Check)</div>
        <div id="CHECK" class="loading">ƒêang t·∫£i d·ªØ li·ªáu...</div>
    </section>
</div>

<script>
const SHEET_ID = "1pak2Yy4rZ3U50rYj2rlfCOkqyDDpnOns";

async function loadSheet(sheetName, targetId) {
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(sheetName)}`;
    
    try {
        const r = await fetch(url);
        const txt = await r.text();
        const json = JSON.parse(txt.substring(47).slice(0, -2));
        const rows = json.table.rows;
        const cols = json.table.cols;

        let tableClass = (targetId === "MATCHES") ? "tbl-matches" : "";
        let html = `<div class="table-wrapper"><table class="${tableClass}"><thead><tr>`;
        
        for(let i=0; i < cols.length; i++) {
            let label = cols[i].label ? cols[i].label : "";
            if(label === "NG√ÄY") label = "N";
            if(label === "TH√ÅNG") label = "T";
            html += `<th>${label}</th>`;
        }
        html += `</tr></thead><tbody>`;

        rows.forEach(row => {
            if (!row.c || !row.c.some(cell => cell && cell.v !== null)) return;

            html += `<tr>`;
            for(let i=0; i < cols.length; i++) {
                let cell = row.c[i];
                let val = "";
                if (cell) {
                    val = cell.f ? cell.f : (cell.v !== null ? cell.v : "");
                }
                
                // Bao b·ªçc gi√° tr·ªã t·ª∑ s·ªë ƒë·ªÉ cƒÉn gi·ªØa tuy·ªát ƒë·ªëi
                if (targetId === "MATCHES" && (i === 4 || i === 5)) {
                    val = `<span class="score-val">${val}</span>`;
                }

                html += `<td>${val}</td>`;
            }
            html += `</tr>`;
        });

        html += `</tbody></table></div>`;
        document.getElementById(targetId).innerHTML = html;
    } catch (err) {
        document.getElementById(targetId).innerHTML = "<p style='text-align:center'>Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu tab n√†y.</p>";
    }
}

// T·ª± ƒë·ªông t·∫£i t·∫•t c·∫£ c√°c b·∫£ng khi m·ªü web
window.addEventListener('DOMContentLoaded', () => {
    loadSheet("BXH", "BXH");
    loadSheet("MATCHES", "MATCHES");
    loadSheet("TEAMS", "TEAMS");
    loadSheet("PAIRS", "PAIRS");
    loadSheet("CHECK", "CHECK");
});
</script>

</body>
</html>
