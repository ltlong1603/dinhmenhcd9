<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TENNIS CD9 2026</title>
    <style>
        :root {
            --primary: #1b5e20;
            --accent: #ffff00;
            --dark: #121212;
            --bg: #f0f0f0;
        }

        body {
            margin: 0;
            font-family: -apple-system, system-ui, sans-serif;
            background: var(--bg);
            color: #333;
            padding-bottom: 50px;
        }

        header {
            background: var(--dark);
            color: var(--accent);
            text-align: center;
            padding: 20px 0;
            font-size: 22px;
            font-weight: 900;
            text-transform: uppercase;
            border-bottom: 4px solid var(--primary);
            position: sticky;
            top: 0;
            z-index: 2000;
        }

        .section-title {
            background: var(--primary);
            color: white;
            padding: 10px;
            margin-top: 20px;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: sticky;
            top: 65px;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .container { padding: 10px; max-width: 100%; }

        .table-wrapper {
            background: white;
            margin-bottom: 10px;
            overflow-x: auto;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 10px 2px;
            text-align: center;
            vertical-align: middle;
            font-size: 13px;
            word-wrap: break-word;
        }

        th {
            background: #f8f9fa;
            color: #000;
            font-weight: bold;
            font-size: 11px;
        }

        /* Fix c·ªôt MATCHES - C·∫•u tr√∫c 7 c·ªôt t·ª´ Sheet */
        .tbl-matches th:nth-child(1), .tbl-matches td:nth-child(1) { width: 30px; } /* N */
        .tbl-matches th:nth-child(2), .tbl-matches td:nth-child(2) { width: 30px; } /* T */
        .tbl-matches th:nth-child(3), .tbl-matches td:nth-child(3) { width: 45px; } /* NƒÉm */
        .tbl-matches th:nth-child(4), .tbl-matches td:nth-child(4) { width: auto; font-weight: 600; } /* Team 1 */
        .tbl-matches td:nth-child(5), .tbl-matches td:nth-child(6) { 
            width: 32px; 
            background: #fffde7 !important; 
            font-weight: bold; 
            color: #d32f2f;
            font-size: 15px;
        } /* Hai √¥ t·ª∑ s·ªë */
        .tbl-matches th:nth-child(7), .tbl-matches td:nth-child(7) { width: auto; font-weight: 600; } /* Team 2 */

        .loading { text-align: center; padding: 30px; font-style: italic; color: #888; }
        section { margin-bottom: 30px; }

        @media (max-width: 480px) {
            th, td { font-size: 12px; }
            .section-title { font-size: 14px; }
        }
    </style>
</head>
<body>

<header>TENNIS CD9 2026</header>

<div class="container">
    <section id="sec-BXH">
        <div class="section-title">üèÜ B·∫£ng X·∫øp H·∫°ng (BXH)</div>
        <div id="BXH" class="loading">ƒêang t·∫£i d·ªØ li·ªáu...</div>
    </section>

    <section id="sec-MATCHES">
        <div class="section-title">üéæ L·ªãch Thi ƒê·∫•u & K·∫øt Qu·∫£</div>
        <div id="MATCHES" class="loading">ƒêang t·∫£i d·ªØ li·ªáu...</div>
    </section>

    <section id="sec-PAIRS">
        <div class="section-title">ü§ù Danh S√°ch C·∫∑p ƒê·∫•u</div>
        <div id="PAIRS" class="loading">ƒêang t·∫£i d·ªØ li·ªáu...</div>
    </section>

    <section id="sec-TEAMS">
        <div class="section-title">üë• Danh S√°ch Teams</div>
        <div id="TEAMS" class="loading">ƒêang t·∫£i d·ªØ li·ªáu...</div>
    </section>

    <section id="sec-CHECK">
        <div class="section-title">‚úÖ Ki·ªÉm Tra (Check)</div>
        <div id="CHECK" class="loading">ƒêang t·∫£i d·ªØ li·ªáu...</div>
    </section>
</div>

<script>
const SHEET_ID = "1pak2Yy4rZ3U50rYj2rlfCOkqyDDpnOns";

async function loadSheet(sheetName, targetId) {
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(sheetName)}`;
    
    try {
        const r = await fetch(url);
        const txt = await r.text();
        const json = JSON.parse(txt.substring(47).slice(0, -2));
        const rows = json.table.rows;
        const cols = json.table.cols;

        let html = `<div class="table-wrapper"><table class="${targetId === 'MATCHES' ? 'tbl-matches' : ''}"><thead><tr>`;
        
        // X·ª¨ L√ù HEADER ƒê·∫∂C BI·ªÜT CHO MATCHES
        if (targetId === "MATCHES") {
            html += `
                <th>N</th>
                <th>T</th>
                <th>NƒÉm</th>
                <th>ƒê·ªôi 1</th>
                <th colspan="2">T·ª∑ S·ªë</th>
                <th>ƒê·ªôi 2</th>
            `;
        } else {
            for(let i=0; i < cols.length; i++) {
                let label = cols[i].label ? cols[i].label : "";
                html += `<th>${label}</th>`;
            }
        }
        
        html += `</tr></thead><tbody>`;

        rows.forEach(row => {
            if (!row.c || !row.c.some(cell => cell && cell.v !== null)) return;
            html += `<tr>`;
            // Lu√¥n ch·∫°y theo s·ªë l∆∞·ª£ng c·ªôt c·ªßa Header (cols.length) ƒë·ªÉ tr√°nh l·ªách
            for(let i=0; i < (targetId === "MATCHES" ? 7 : cols.length); i++) {
                let cell = row.c[i];
                let val = "";
                if (cell) {
                    val = cell.f ? cell.f : (cell.v !== null ? cell.v : "");
                }
                html += `<td>${val}</td>`;
            }
            html += `</tr>`;
        });

        html += `</tbody></table></div>`;
        document.getElementById(targetId).innerHTML = html;
    } catch (err) {
        document.getElementById(targetId).innerHTML = "<p style='text-align:center'>L·ªói t·∫£i d·ªØ li·ªáu.</p>";
    }
}

window.addEventListener('DOMContentLoaded', () => {
    loadSheet("BXH", "BXH");
    loadSheet("MATCHES", "MATCHES");
    loadSheet("PAIRS", "PAIRS"); // T·∫£i PAIRS tr∆∞·ªõc
    loadSheet("TEAMS", "TEAMS"); // T·∫£i TEAMS sau
    loadSheet("CHECK", "CHECK");
});
</script>

</body>
</html>
