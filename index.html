<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TENNIS CD9 2026</title>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
  background:#f4f4f4;
}
header{
  background:#000;
  color:#fff;
  text-align:center;
  padding:14px;
  font-weight:700;
}
nav{
  display:flex;
  background:#111;
}
nav button{
  flex:1;
  padding:12px;
  background:#111;
  color:#fff;
  border:none;
  font-weight:600;
}
nav button.active{
  background:#fff;
  color:#000;
}
section{
  display:none;
  padding:12px;
}
section.active{
  display:block;
}

table{
  width:100%;
  border-collapse:collapse;
  background:#fff;
}
th,td{
  border:1px solid #ddd;
  padding:6px;
  text-align:center;
  font-size:14px;
}
th{
  background:#eee;
  font-weight:700;
}

/* MATCHES layout */
.matches-title{
  background:#000;
  color:#ffe600;
  font-weight:800;
  text-align:center;
  padding:8px;
  margin-bottom:6px;
}
.matches-sub{
  background:#caffc9;
  font-weight:700;
}
.col-day,.col-month,.col-year{ width:8%; }
.col-team{ width:18%; }
.col-score{ width:8%; background:#fffda0; }
.col-score2{ width:8%; background:#fffda0; }
.col-team2{ width:18%; }

@media(max-width:600px){
  th,td{ font-size:12px; padding:4px; }
}
</style>
</head>

<body>

<header>TENNIS CD9 2026</header>

<nav>
  <button onclick="showTab('BXH')" class="active">BXH</button>
  <button onclick="showTab('MATCHES')">MATCHES</button>
  <button onclick="showTab('TEAMS')">TEAMS</button>
  <button onclick="showTab('PAIRS')">PAIRS</button>
  <button onclick="showTab('CHECK')">CHECK</button>
</nav>

<section id="BXH" class="active"></section>
<section id="MATCHES"></section>
<section id="TEAMS"></section>
<section id="PAIRS"></section>
<section id="CHECK"></section>

<script>
const SHEET_ID = "1pak2Yy4rZ3U50rYj2rlfCOkqyDDpnOns";

function gviz(sheet){
  return `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${sheet}`;
}

function showTab(id){
  document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
  document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  event.target.classList.add("active");
}

function clean(v){
  return (v===null || v===undefined) ? "" : v;
}

function loadSimpleTable(sheet, target){
  fetch(gviz(sheet))
  .then(r=>r.text())
  .then(t=>{
    const json = JSON.parse(t.substring(47).slice(0,-2));
    const cols = json.table.cols.map(c=>c.label);
    const rows = json.table.rows;

    let html="<table><tr>";
    cols.forEach(c=>html+=`<th>${c}</th>`);
    html+="</tr>";

    rows.forEach(r=>{
      html+="<tr>";
      r.c.forEach(c=>html+=`<td>${clean(c?.v)}</td>`);
      html+="</tr>";
    });

    html+="</table>";
    document.getElementById(target).innerHTML=html;
  });
}

/* MATCHES custom layout */
function loadMatches(){
  fetch(gviz("MATCHES"))
  .then(r=>r.text())
  .then(t=>{
    const j=JSON.parse(t.substring(47).slice(0,-2));
    const r=j.table.rows;

    let html=`
    <div class="matches-title">CHI TIẾT KẾT QUẢ TỪNG TRẬN ĐẤU</div>
    <table>
      <tr class="matches-sub">
        <th colspan="3">NGÀY THÁNG NĂM</th>
        <th colspan="4">DANH SÁCH CÁC CẶP ĐẤU</th>
      </tr>
      <tr>
        <th class="col-day"></th>
        <th class="col-month"></th>
        <th class="col-year"></th>
        <th class="col-team">Sân Ngon</th>
        <th class="col-score">Tỷ số</th>
        <th class="col-score2"></th>
        <th class="col-team2">Sân Mù Mắt</th>
      </tr>
    `;

    r.forEach(x=>{
      html+=`
      <tr>
        <td>${clean(x.c[0]?.v)}</td>
        <td>${clean(x.c[1]?.v)}</td>
        <td>${clean(x.c[2]?.v)}</td>
        <td>${clean(x.c[3]?.v)}</td>
        <td>${clean(x.c[4]?.v)}</td>
        <td>${clean(x.c[5]?.v)}</td>
        <td>${clean(x.c[6]?.v)}</td>
      </tr>`;
    });

    html+="</table>";
    document.getElementById("MATCHES").innerHTML=html;
  });
}

/* Load all */
loadSimpleTable("BXH","BXH");
loadMatches();
loadSimpleTable("TEAMS","TEAMS");
loadSimpleTable("PAIRS","PAIRS");
loadSimpleTable("CHECK","CHECK");
</script>

</body>
</html>
