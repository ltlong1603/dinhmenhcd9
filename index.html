<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Giáº£i Äáº¥u Tennis CD9</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body { font-family: Arial, sans-serif; padding:0; margin:0; background:#fafafa; }
.container { max-width: 1000px; margin:auto; padding: 10px; }
h2 { text-align:center; color:#222; margin-top:20px; }

/* báº£ng */
table { width:100%; border-collapse:collapse; margin-bottom:20px; }
th,td { border:1px solid #ccc; padding:8px; }
th { background:#4caf50; color:#fff; font-size:16px; }
td { font-size:14px; text-align:center; }

/* responsive */
@media only screen and (max-width:600px) {
  table,thead,tbody,th,td,tr{display:block;}
  th { background:#4caf50; color:#fff; text-align:left; }
  td { text-align:right; padding-left:50%; position:relative; }
  td:before { position:absolute; left:10px; width:45%; white-space:nowrap; content:attr(data-label); font-weight:bold; }
}
</style>
</head>

<body>
<div class="container">

  <h2>ğŸ† Báº¢NG Xáº¾P Háº NG</h2>
  <table id="tbl-bxh"></table>

  <h2>ğŸ“‹ CHI TIáº¾T Tá»ªNG TRáº¬N Äáº¤U</h2>
  <table id="tbl-matches"></table>

  <h2>ğŸ” TRA Cá»¨U THEO Äá»˜I</h2>
  <select id="team-select" onchange="renderTeamResult()">
    <option value="">-- Chá»n Ä‘á»™i --</option>
  </select>
  <table id="tbl-team"></table>

  <h2>ğŸ‘¥ DANH SÃCH Äá»˜I</h2>
  <table id="tbl-teams"></table>

  <h2>ğŸ“Š THÃ”NG TIN CÃC Cáº¶P Äáº¤U</h2>
  <table id="tbl-pairs"></table>

</div>

<script>
const sheetID = "1pak2Yy4rZ3U50rYj2rlfCOkqyDDpnOns";

// helper fetch
function fetchRange(range) {
  const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?range=${range}`;
  return fetch(url)
    .then(res => res.text())
    .then(txt => JSON.parse(txt.substring(txt.indexOf("{"), txt.lastIndexOf("}") + 1)))
    .then(obj => obj.table.rows);
}

// render table from rows
function renderTable(rows, columns, elementId) {
  let html = "<tr>";
  columns.forEach(c => html += `<th>${c}</th>`);
  html += "</tr>";
  rows.forEach(r => {
    html += "<tr>";
    columns.forEach((col,i) => {
      const value = r.c[i] ? r.c[i].v : "";
      html += `<td data-label="${col}">${value}</td>`;
    });
    html += "</tr>";
  });
  document.getElementById(elementId).innerHTML = html;
}

// 1: BXH
fetchRange("BXH!A1:H100")
  .then(rows => renderTable(rows,
    ["Háº¡ng","Äá»™i","Tráº­n","Tháº¯ng","HÃ²a","Thua","Hiá»‡u sá»‘","Äiá»ƒm"], "tbl-bxh"));

// 2: MATCHES
fetchRange("MATCHES!A1:F100")
  .then(rows => renderTable(rows,
    ["NgÃ y","ThÃ¡ng","NÄƒm","Äá»™i A","Tá»· sá»‘","Äá»™i B"], "tbl-matches"));

// 3: TEAMS + fill dropdown
fetchRange("TEAMS!A1:C100")
  .then(rows => {
    renderTable(rows, ["Äá»™i","TÃªn VÄV","CODE"], "tbl-teams");
    const sel = document.getElementById("team-select");
    rows.forEach(r => {
      const code = r.c[2] ? r.c[2].v : "";
      if(code) sel.innerHTML += `<option value="${code}">${code}</option>`;
    });
  });

// 4: PAIRS
fetchRange("PAIRS!A1:E50")
  .then(rows => renderTable(rows,
    ["","D1","D2","D3","D4"], "tbl-pairs"));

// store all matches for filter
let allMatches = [];
fetchRange("MATCHES!A1:F100").then(rows => allMatches = rows);

// render team results
function renderTeamResult() {
  const team = document.getElementById("team-select").value;
  if (!team) {
    document.getElementById("tbl-team").innerHTML = "";
    return;
  }
  const filtered = allMatches.filter(r => {
    const A = r.c[3] ? r.c[3].v : "";
    const B = r.c[5] ? r.c[5].v : "";
    return A === team || B === team;
  });

  let html = "<tr><th>NgÃ y</th><th>Äá»™i A</th><th>Tá»· sá»‘</th><th>Äá»™i B</th></tr>";
  filtered.forEach(r => {
    const date = `${r.c[0].v}-${r.c[1].v}-${r.c[2].v}`;
    const score = r.c[4] ? r.c[4].v : "";
    html += `<tr><td>${date}</td><td>${r.c[3].v}</td><td>${score}</td><td>${r.c[5].v}</td></tr>`;
  });
  document.getElementById("tbl-team").innerHTML = html;
}
</script>

</body>
</html>
