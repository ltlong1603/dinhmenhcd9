<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Gi·∫£i ƒë·∫•u Tennis CD9</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h2 { color: #333; }
    table { border-collapse: collapse; width: 100%; margin-bottom: 30px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background: #4CAF50; color: white;}
  </style>
</head>
<body>

<h1>üèÜ Gi·∫£i ƒë·∫•u Tennis CD9</h1>

<h2>B·∫£ng x·∫øp h·∫°ng</h2>
<table id="table-bxh"></table>

<h2>Chi ti·∫øt k·∫øt qu·∫£ t·ª´ng tr·∫≠n ƒë·∫•u</h2>
<table id="table-matches"></table>

<h2>Tra c·ª©u theo ƒë·ªôi</h2>
<select id="team-select"></select>
<table id="table-lookup"></table>

<h2>Th√¥ng tin c√°c c·∫∑p ƒë·∫•u</h2>
<table id="table-pairs"></table>

<h2>Danh s√°ch ƒë·ªôi & VƒêV</h2>
<table id="table-teams"></table>

<script>
  const sheetID = "1pak2Yy4rZ3U50rYj2rlfCOkqyDDpnOns";

  function fetchSheet(sheetName, callback) {
    const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?sheet=${sheetName}`;
    fetch(url)
      .then(res => res.text())
      .then(rep => {
        const json = JSON.parse(rep.substring(rep.indexOf("{"), rep.lastIndexOf("}") + 1));
        callback(json.table.rows);
      });
  }

  function renderTable(rows, elementId) {
    let html = "<tr>";
    rows[0].c.forEach(c => html += `<th>${c && c.v ? c.v : ""}</th>`);
    html += "</tr>";

    for (let i = 1; i < rows.length; i++) {
      html += "<tr>";
      rows[i].c.forEach(c => html += `<td>${c && c.v ? c.v : ""}</td>`);
      html += "</tr>";
    }

    document.getElementById(elementId).innerHTML = html;
  }

  // 1. B·∫£ng x·∫øp h·∫°ng
  fetchSheet("BXH", rows => renderTable(rows, "table-bxh"));

  // 2. Chi ti·∫øt tr·∫≠n ƒë·∫•u
  fetchSheet("MATCHES", rows => renderTable(rows, "table-matches"));

  // 3. Danh s√°ch ƒë·ªôi
  fetchSheet("TEAMS", rows => renderTable(rows, "table-teams"));

  // 4. Ma tr·∫≠n c·∫∑p ƒë·∫•u
  fetchSheet("PAIRS", rows => renderTable(rows, "table-pairs"));

  // 5. Tra c·ª©u theo ƒë·ªôi
  fetchSheet("MATCHES", rows => {
    const teams = {};
    rows.forEach(r => {
      if (r.c[1] && r.c[1].v) teams[r.c[1].v] = true;
      if (r.c[3] && r.c[3].v) teams[r.c[3].v] = true;
    });

    const select = document.getElementById("team-select");
    Object.keys(teams).forEach(t => {
      const option = document.createElement("option");
      option.value = t;
      option.text = t;
      select.add(option);
    });

    select.onchange = () => {
      let html = "<tr><th>Ng√†y</th><th>ƒê·ªôi 1</th><th>T·ª∑ s·ªë</th><th>ƒê·ªôi 2</th></tr>";
      rows.forEach(r => {
        if (r.c[1] && r.c[1].v === select.value || r.c[3] && r.c[3].v === select.value) {
          html += "<tr>";
          html += `<td>${r.c[0] && r.c[0].v ? r.c[0].v : ""}</td>`;
          html += `<td>${r.c[1] && r.c[1].v ? r.c[1].v : ""}</td>`;
          html += `<td>${r.c[2] && r.c[2].v ? r.c[2].v : ""}</td>`;
          html += `<td>${r.c[3] && r.c[3].v ? r.c[3].v : ""}</td>`;
          html += "</tr>";
        }
      });
      document.getElementById("table-lookup").innerHTML = html;
    };
  });
</script>

</body>
</html>
